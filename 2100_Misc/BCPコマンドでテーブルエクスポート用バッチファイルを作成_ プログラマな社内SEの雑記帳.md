---
title: 'BCPコマンドでテーブルエクスポート用バッチファイルを作成: プログラマな社内SEの雑記帳'
updated: 2017-01-17 13:24:15Z
created: 2017-01-17 13:24:15Z
source: http://seiic.blog.so-net.ne.jp/2008-09-02
tags:
  - SI
---

# プログラマな社内SEの雑記帳

大型汎用機の運用会社で運用を経験し、派遣プログラマを経験して、現在、社内SEとして必死に奮闘している管理人が書いている日々の雑記です。

## BCPコマンドでテーブルエクスポート用バッチファイルを作成　[[SQLServer]](http://seiic.blog.so-net.ne.jp/archive/c2300317999-1) [[編集]](https://blog.so-net.ne.jp/MyPage/blog/article/edit/input?reload_blog_id=105338&id=9485191)

先日、SQLServer2005にてBCPコマンドを使用した
テーブルの全レコードをエクスポートするバッチファイル(拡張子「bat」)を
作成しました。

BCPコマンドは使用したことがなかったのですが、
書籍やネットで調べながら、何とか作る事ができました。

やっぱりバッチファイル(スクリプト)はGUIでマウス操作するよりも楽でいいですね。

バッチファイルを一度作ってしまえば、
次からはバッチファイルをダブルクリックするだけで、
やりたいことは全てバッチファイルが実行してくれますので、
かなり時間短縮できて効率的ですね。

以下、仕事で作成したバッチファイルを修正して、サンプルを作ってみました。
自分にとっての備忘録としても活用します(笑)

================================================================================

テーブルのエクスポートサンプル(バッチファイル[.bat])

================================================================================

rem テーブルのエクスポート(タブ区切りファイルでエクスポートする)

rem 実行結果ログ出力ファイル名を含むフルパスを設定する
set logfile=d:\ExportTable.log

rem テーブルのエクスポートを行う

bcp "testdb.dbo.table1" out "d:\table1.txt" -S TESTPC -U testuser -P test -c -t"\t" > %logfile%

bcp "testdb.dbo.table2" out "d:\table2.txt" -S TESTPC -U testuser -P test -c -t"\t" >> %logfile%

echo. >> %logfile%
echo "テーブルのエクスポートが正常に終了しました。" >> %logfile%

pause "テーブルのエクスポートが正常に終了しました。詳細は「" %logfile% "」をテキストエディタで開いて確認してください。"

================================================================================

テーブルのインポートサンプル(バッチファイル[.bat])

================================================================================

rem テーブルのインポート(タブ区切りファイルからインポートする)

rem 実行結果ログ出力ファイル名を含むフルパスを設定する
set logfile=d:\Import_Table.log

rem テーブルのインポートを行う

bcp "testdb.dbo.table1" in "d:\table1.txt" -S TESTPC -U testuser -P test -c -t"\t" > %logfile%

bcp "testdb.dbo.table2" in "d:\table2.txt" -S TESTPC -U testuser -P test -c -t"\t" >> %logfile%

echo. >> %logfile%
echo "テーブルのインポートが正常に終了しました。" >> %logfile%

pause "テーブルのインポートが正常に終了しました。詳細は「" %logfile% "」をテキストエディタで開いて確認してください。"

データベースのデータバックアップ用途など、
作業簡略化のために少しでもお役に立てば幸いです。
←ブログランキングに参加しておりますので、ぜひ応援のクリックをお願いします。
2008-09-02 00:35  nice!(0)
コメント(0)
トラックバック(0)

共通テーマ：[パソコン・インターネット](http://blog.so-net.ne.jp/_contents/genre/0019/recent_articles/0001.html)

#### nice! 0

#### コメント 0

#### コメントを書く

お名前：
URL：
コメント：
画像認証：
下の画像に表示されている文字を入力してください。
![seesaa_captcha_comment.gif](../_resources/seesaa_captcha_comment.gif)

#### トラックバック 0

この記事のトラックバックURL：
※言及リンクのないトラックバックは受信されません。