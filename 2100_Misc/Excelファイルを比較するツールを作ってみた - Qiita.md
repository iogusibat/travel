---
title: Excelファイルを比較するツールを作ってみた - Qiita
updated: 2018-03-10 12:55:37Z
created: 2018-03-10 12:55:37Z
source: https://qiita.com/skanmera/items/d1dea61a7077f320524e
author: xyvyx10
tags:
  - Web
---

# Excelファイルを比較するツールを作ってみた

[(L)](https://camo.qiitausercontent.com/28bef8fc1314490664ac7a1af9fece42c52da46e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f38646464636164302d353136652d616538622d366666302d6162383538393534376534332e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f38646464636164302d353136652d616538622d366666302d6162383538393534376534332e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f38646464636164302d353136652d616538622d366666302d6162383538393534376534332e706e67.png)](https://camo.qiitausercontent.com/28bef8fc1314490664ac7a1af9fece42c52da46e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f38646464636164302d353136652d616538622d366666302d6162383538393534376534332e706e67)

# はじめに

Excelファイルの比較には***WinMerge***に***xdocdiff***のプラグインを入れて使っていたのですが、
列が揃ってなかったり、ヘッダを固定できなかったりと少し不便に感じていました。
そんなわけでExcelファイルを比較するツールを自作してみたので、紹介と使い方を書いていこうと思います。

# 注意

このツールは筆者の仕事環境において必要最低限の要件で作成しています

# インストール

### [ここ](https://github.com/skanmera/ExcelMerge/releases) から最新の.msiをダウンロードする

[(L)](https://camo.qiitausercontent.com/aa0de83068737cdbdb243016b8ecc8ed29a5c4f5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f62376336306633642d643433652d396533642d646563322d3333653464633632323162382e706e67)

[![SnapCrab_NoName_2017-10-29_16-4-52_No-00.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f62376336306633642d643433652d396533642d646563322d3333653464633632323162382e706e67.png)](https://camo.qiitausercontent.com/aa0de83068737cdbdb243016b8ecc8ed29a5c4f5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f62376336306633642d643433652d396533642d646563322d3333653464633632323162382e706e67)

### ダウンロードしてインストーラーを実行する

※電子署名をしていないので、以下のウィンドウが表示されると思います。「詳細」→「実行」で実行できます。

[(L)](https://camo.qiitausercontent.com/3320a049a83e33fdfc62dee42c1572bc49451b19/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39323134333666632d356162342d373266612d333366632d3161346661353661353339302e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39323134333666632d356162342d373266612d333366632d3161346661353661353339302e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39323134333666632d356162342d373266612d333366632d3161346661353661353339302e706e67.png)](https://camo.qiitausercontent.com/3320a049a83e33fdfc62dee42c1572bc49451b19/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39323134333666632d356162342d373266612d333366632d3161346661353661353339302e706e67)

[(L)](https://camo.qiitausercontent.com/2890793ef5b3d7eacf81fb760a5a9231865b8918/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f65636336313031622d633734622d663864312d373736382d6163633732323731343761372e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f65636336313031622d633734622d663864312d373736382d6163633732323731343761372e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f65636336313031622d633734622d663864312d373736382d6163633732323731343761372e706e67.png)](https://camo.qiitausercontent.com/2890793ef5b3d7eacf81fb760a5a9231865b8918/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f65636336313031622d633734622d663864312d373736382d6163633732323731343761372e706e67)

### Nextを選択

[(L)](https://camo.qiitausercontent.com/7e3679d5a265302d52ec6864eb02f84bee6b9d6a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63373566613734342d383433352d626133622d666233642d3466643765376639653830372e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63373566613734342d383433352d626133622d666233642d3466643765376639653830372e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63373566613734342d383433352d626133622d666233642d3466643765376639653830372e706e67.png)](https://camo.qiitausercontent.com/7e3679d5a265302d52ec6864eb02f84bee6b9d6a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63373566613734342d383433352d626133622d666233642d3466643765376639653830372e706e67)

### インストールするディレクトリと、ユーザーを選択 (特に指定がなければそのままNext)

[(L)](https://camo.qiitausercontent.com/4334e7a3da8983f3b32b19f9e9cdb945b6da4676/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39623038373464372d323564642d303034322d663966362d3334353730363836366437342e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39623038373464372d323564642d303034322d663966362d3334353730363836366437342e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39623038373464372d323564642d303034322d663966362d3334353730363836366437342e706e67.png)](https://camo.qiitausercontent.com/4334e7a3da8983f3b32b19f9e9cdb945b6da4676/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f39623038373464372d323564642d303034322d663966362d3334353730363836366437342e706e67)

### Nextを選択

[(L)](https://camo.qiitausercontent.com/65ac884f4f01acefc5043815cc235e854a296c53/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31343563313932312d363139342d313964312d623361372d3962333238663739386534392e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31343563313932312d363139342d313964312d623361372d3962333238663739386534392e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31343563313932312d363139342d313964312d623361372d3962333238663739386534392e706e67.png)](https://camo.qiitausercontent.com/65ac884f4f01acefc5043815cc235e854a296c53/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31343563313932312d363139342d313964312d623361372d3962333238663739386534392e706e67)

# 起動方法

### 　ショートカットアイコン

インストールが完了すると、デスクトップにショートカットアイコンが作成されるので、起動して上部メニューの「ファイル」から比較するファイルを選択する

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f64643832626465632d393164642d613664652d376261382d6634643133376163323262652e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f64643832626465632d393164642d613664652d376261382d6634643133376163323262652e706e67.png)](https://camo.qiitausercontent.com/a45727e879f0ed027dad9661810a1d8b23092d49/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f64643832626465632d393164642d613664652d376261382d6634643133376163323262652e706e67)

### エクスプローラのコンテキストメニュー

エクスプローラでファイルを選択した状態でコンテキストメニューを開き、ExcelMergeを選択する

[(L)](https://camo.qiitausercontent.com/81cdcb82a4e6e864ee6a981315f462f3019c3306/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f61313130616563612d356565382d346630642d396530382d3133333534326131323462632e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f61313130616563612d356565382d346630642d396530382d3133333534326131323462632e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f61313130616563612d356565382d346630642d396530382d3133333534326131323462632e706e67.png)](https://camo.qiitausercontent.com/81cdcb82a4e6e864ee6a981315f462f3019c3306/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f61313130616563612d356565382d346630642d396530382d3133333534326131323462632e706e67)

### コマンドライン

コマンドラインからオプションを指定して起動することもできます

オプションに関しては [README](https://github.com/skanmera/ExcelMerge#from-command-line) を参照してください

# 使い方

## 差分を抽出する

ファイルを選択している状態で「差分抽出」を実行することで選択中のシートの比較結果が表示されます。

[(L)](https://camo.qiitausercontent.com/a313ddd763bf6f9b89e5de4b5c3ea2f39f99ce68/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63666263306434642d636534642d336637612d663333622d3632316666383763306132622e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63666263306434642d636534642d336637612d663333622d3632316666383763306132622e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63666263306434642d636534642d336637612d663333622d3632316666383763306132622e706e67.png)](https://camo.qiitausercontent.com/a313ddd763bf6f9b89e5de4b5c3ea2f39f99ce68/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f63666263306434642d636534642d336637612d663333622d3632316666383763306132622e706e67)

コンテキストメニューやコマンドラインから起動した場合、差分が抽出可能であれば自動で抽出されます。

## 列ヘッダ、行ヘッダを変更する

デフォルトで列ヘッダは0行目の内容が、行ヘッダは行のインデックスが表示されます。
変更するには変更したい行、または列の任意のセルを選択した状態でコンテキストメニューを開き「列ヘッダに設定」または「行ヘッダに設定」を選択します
デフォルトで表示されている行インデックスから「氏名」に変更する場合

[(L)](https://camo.qiitausercontent.com/d4a82776f1c110a4b2f4cfbab0894c9870a1fce7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35343962356135652d383664342d353339342d633233362d3737636631623033383636632e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35343962356135652d383664342d353339342d633233362d3737636631623033383636632e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35343962356135652d383664342d353339342d633233362d3737636631623033383636632e706e67.png)](https://camo.qiitausercontent.com/d4a82776f1c110a4b2f4cfbab0894c9870a1fce7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35343962356135652d383664342d353339342d633233362d3737636631623033383636632e706e67)

[(L)](https://camo.qiitausercontent.com/b265bfca8967084075d555818f7a6472c54a97c1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36316666383166612d396232362d363530642d366432652d3266353738373830656464652e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36316666383166612d396232362d363530642d366432652d3266353738373830656464652e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36316666383166612d396232362d363530642d366432652d3266353738373830656464652e706e67.png)](https://camo.qiitausercontent.com/b265bfca8967084075d555818f7a6472c54a97c1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36316666383166612d396232362d363530642d366432652d3266353738373830656464652e706e67)

[(L)](https://camo.qiitausercontent.com/8f520a94adcdf953509cab61e5088efdd6aef828/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35353238383336662d366665382d383934652d623038382d3266313265393433393264382e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35353238383336662d366665382d383934652d623038382d3266313265393433393264382e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35353238383336662d366665382d383934652d623038382d3266313265393433393264382e706e67.png)](https://camo.qiitausercontent.com/8f520a94adcdf953509cab61e5088efdd6aef828/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f35353238383336662d366665382d383934652d623038382d3266313265393433393264382e706e67)

## ファイルごとに設定を作成する

毎回列ヘッダや行ヘッダを設定するのは面倒なので、事前にファイルごとに設定を行います
上部メニューの「設定」から「ファイル設定」を選択し、追加ボタンを選択します

[(L)](https://camo.qiitausercontent.com/168ce538e3624f1078d6eb80d0f2cb4238706311/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36383861373231352d613761642d613237352d623931322d3235343162356632396632352e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36383861373231352d613761642d613237352d623931322d3235343162356632396632352e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36383861373231352d613761642d613237352d623931322d3235343162356632396632352e706e67.png)](https://camo.qiitausercontent.com/168ce538e3624f1078d6eb80d0f2cb4238706311/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36383861373231352d613761642d613237352d623931322d3235343162356632396632352e706e67)

設定を追加します

[(L)](https://camo.qiitausercontent.com/d70c1bd77b59e0875bd4251fad7291982d690c43/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31333039343163392d656530632d633461622d323161632d3831326530636465363562302e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31333039343163392d656530632d633461622d323161632d3831326530636465363562302e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31333039343163392d656530632d633461622d323161632d3831326530636465363562302e706e67.png)](https://camo.qiitausercontent.com/d70c1bd77b59e0875bd4251fad7291982d690c43/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f31333039343163392d656530632d633461622d323161632d3831326530636465363562302e706e67)

- 「名前」はファイル名か正規表現で記述します
- 「行ヘッダインデックス」は-1で行インデックスが表示されます
- 「行ヘッダ」名は「行ヘッダインデックス」が指定しにくい場合などに、列ヘッダの名前で指定します。※同じ列ヘッダ名が複数存在するときは最初に一致したものを表示します
- ファイル名を指定した場合は完全一致をチェックします

## バージョン管理ツールのDiffツールとして使用する

### 外部ツールを登録する

バージョン管理ツールのDiffツールとして使用する場合、テキストファイルや画像ファイルなどは通常のDiffツールで開く必要があるので、
サポート対象外のファイルの場合に起動する外部ツールを登録する必要があります。
※ここではWinMergeを外部ツールとして登録します
上部メニューの「設定」から「外部コマンド」を選択し、追加ボタンを選択します

[(L)](https://camo.qiitausercontent.com/50a67dd249de5e049932c9d305f202d5f1fee443/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36626236343937302d393065332d366237392d376236332d6662316363353236353563372e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36626236343937302d393065332d366237392d376236332d6662316363353236353563372e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36626236343937302d393065332d366237392d376236332d6662316363353236353563372e706e67.png)](https://camo.qiitausercontent.com/50a67dd249de5e049932c9d305f202d5f1fee443/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f36626236343937302d393065332d366237392d376236332d6662316363353236353563372e706e67)

- 「名前」はこのコマンドの名前を登録します。コマンドラインから起動する際に指定されます
- 「実行ファイル」は実行するexeなどのパスを指定します
- 「引数」には実行ファイルに渡す引数を指定します

#### 利用可能な変数

変数
説明
`${SRC}`
右側のファイルパス
`${DST}`
左側のファイルパス

### Gitの外部ツールとして登録する

.gitconfigにdiffツールを追加します
.gitconfig
[diff]
tool = WinMerge
[difftool "WinMerge"]

cmd = \"C:/Project/Github/excelmerge/ExcelMerge.GUI/bin/Debug/ExcelMerge.GUI.exe\" diff -s \"$LOCAL\" -d \"$REMOTE\" -c WinMerge -i -w -v -k

- -c で先ほど登録した外部ツール(WinMerge)を指定しています
- -i で .xls .xlsx .csv　以外のファイルの場合はダイアログなしで外部ツールが起動するように指定しています
- -v で拡張子のチェックをします (-v 指定がないと例外が発生→外部ツール起動 となります)
- -w で外部ツールのプロセス終了を待つようにします (プロセスを待たないと一時ファイルが削除されるため)

これでSourceTreeからも使用が可能になります

[(L)](https://camo.qiitausercontent.com/a6854b9d290584ca07adf871513a6fe14c42aab2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f30356432643933312d313562612d353762312d653465322d6366376264623864386332612e676966)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f30356432643933312d313562612d353762312d653465322d6366376264623864386332612e676966.gif](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f30356432643933312d313562612d353762312d653465322d6366376264623864386332612e676966.gif)](https://camo.qiitausercontent.com/a6854b9d290584ca07adf871513a6fe14c42aab2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f30356432643933312d313562612d353762312d653465322d6366376264623864386332612e676966)

### Mercurialの外部ツールとして登録する

mercurial.iniにdiffツールを追加します
mercurial.ini
[merge-tools]
excelmerge.executable = C:\Program Files (x86)\ExcelMerge\ExcelMerge.GUI.exe

excelmerge.diffargs = diff -s $parent1 -d $child -c WinMerge -i -w -v -e empty -k

[tortoisehg]
vdiff = excelmerge
[extdiff]
#extdiffはコメントアウトする
#cmd.wmdiff = C:\Program Files\WinMerge\WinMergeU.exe
#opts.wmdiff = /r /e /x /ub
Gitの場合とオプションはほぼ同じですが、追加、削除のステータスのファイルを比較するときにemptyというファイル名で空のファイル名が渡されるので
-e で空のファイル名を指定しています

### 変更ログを出力する

コミットログなどに記載する際に、変更点をログとして出力できます。
変更点をログとして出力したいセルを範囲選択します。(全部の場合はCtrl + A)で全選択
コンテキストメニューの「ログを出力」を選択します

[(L)](https://camo.qiitausercontent.com/9e854f0ea51949f22db398e34a07a1cb41007b65/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f32363666356433612d373630312d333363662d626261322d3434323638373963356538392e706e67)

[![68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f32363666356433612d373630312d333363662d626261322d3434323638373963356538392e706e67.png](../_resources/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f32363666356433612d373630312d333363662d626261322d3434323638373963356538392e706e67.png)](https://camo.qiitausercontent.com/9e854f0ea51949f22db398e34a07a1cb41007b65/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3230363838312f32363666356433612d373630312d333363662d626261322d3434323638373963356538392e706e67)

ログのフォーマットは「差分抽出設定」から変更可能です。

## ショートカットキー

| キー  | 説明  |
| --- | --- |
| Ctrl + → | 次の変更されたセルに移動 |
| Ctrl + ← | 前の変更されたセルに移動 |
| Ctrl + ↓ | 次の変更された行に移動 |
| Ctrl + ↑ | 前の変更された行に移動 |
| Ctrl + K | 次の追加された行に移動 |
| Ctrl + I | 前の追加された行に移動 |
| Ctrl + L | 次の削除された行に移動 |
| Ctrl + O | 前の削除された行に移動 |
| Ctrl + F | セルを検索 |
| F9  | 次の検索結果に一致するセルに移動 |
| F8  | 前の検索結果に一致するセルに移動 |
| Ctrl + C | 選択したセルをタブ区切りでコピー(エクセルへの貼り付け) |
| Ctrl + Shift + C | 選択したセルをカンマ区切りでコピー |
| Ctrl + D | コンソールを表示(隠す) |
| Ctrl + B | 選択範囲の差分をログとして出力 |

# 問題点

列の追加、削除が複数ある場合、列の並び順が想定通りにならないことがあります。
この場合、コンテキストメニューから正しい列ヘッダ(できるだけ一意なヘッダ)を指定して差分を取ると正常に表示されることがあります。

# プロジェクト

プロジェクトは[GitHub](https://github.com/skanmera/ExcelMerge) で公開しています
Gridはパフォーマンスを優先するため [FastWpfGrid](https://fastwpfgrid.codeplex.com/) を使用しています

# おわりに

今回作成したツールを実際に業務で少し使ってみましたが、
コミット前の差分確認やコンフリクトの解消にかかる時間とストレスを少し軽減できたような気がします。
最終的にはマージする機能を実装することなので、今後も更新していくつもりです。

※この記事で使用したExcelファイルは [こちら](https://hogehoge.tk/personal/generator/) のサイトを利用しました