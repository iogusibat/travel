---
title: 会計仕訳入力を行うための最善条件を踏まえたシステム｜中村勇樹　 ( 資料公開 / 公認会計士・税理士 )｜note
updated: 2021-05-11 04:18:13Z
created: 2021-05-11 04:18:13Z
source: https://note.com/nakamu_cpa/n/n36e34ea25bc4
---

#  会計仕訳入力を行うための最善条件を踏まえたシステム

21

会計事務所向けの、仕訳入力に特化した会計システムを公開します。
------------------------------------
[前回のnote](https://note.com/nakamu_cpa/n/n4904ff9a7b87)で会計入力は今より速くできるという話をしました。
今回はその理屈を踏まえて、どのような解法が出せるのかという話をします。

パンチ最速のための理想は下の条件の達成です。
**１．再利用可能性の最大化**
**２．動作研究の利用による最適化**

この条件達成のために、僕はシステム構築という手段をとりました。

今回解説するのは、上の**２つの理想条件**をシステムでどう実現できるのかです。前回分noteで感じとれると思いますが、この２つの理想条件はかなりハードルの高い課題です。

### 解法１：動作研究の利用

下の画像が作成したシステムです。（以降、**Ｐシステム**と書きます。）
手元にアスクルの1,500円の領収書があったとして、それをパンチしたときの動きをしています。

![picture_pc_4dfdc6b9990cf1afa971b9f5445b4cba.gif](../_resources/picture_pc_4dfdc6b9990cf1afa971b9f5445b4cba.gif)

このときの作業者の動作を分解してみます。
作業者は、右手のテンキーで入力操作を行い、左手はフリーにして領収書をめくっていると想定してください。

**動作行程**
１．領収書持つ（左手）
２．領収書見る
３．日付を打つ（右手）「9 Enter」
４．名前をコードで打つ（右手）「132 Enter」
５．画面に視線を移す
６．該当仕訳を探す
７．該当仕訳の番号打つ（右手）「2 Enter」
８．領収書に視線を移す
９．金額打つ（右手）「1500 Enter」

● サーブリック分析の考えにのっとって、動作行程には視線移動も含めています。軽視されがちですが、視線移動は直後に「探す」動作が入るためミスのもとです。繰り返すと時間もかかります。

● 行程４の「名前をコードで打つ（132）」が理解しがたいですよね。
この点はPシステム最大の工夫点なのですが、最大のとっつきにくい点でもあります。説明は後にまわします。
この作業の効率を成績にすると以下のようになりました。細分化した動作数、キータッチ数（マウス含む）、一仕訳にかかった時間で計測してます。
**動作数：9
キータッチ数：13 回** (9 E 132 E 2 E 1500 E)
**作業時間：4 秒程度**
同じ作業を**会計ソフト**（弥生会計）でしたときの成績はこちらです。辞書に仕訳登録があった前提で打ちました。
**動作数：27
キータッチ数：24 回 ****
作業時間：11秒程度**
Ｐシステムに対しおよそ３倍の効率です。

会計ソフトでの**動作数**を増やした原因は、
● マウスの持ち替え
● 領収書を置いてキーボードに持ち替え
● スクロールして辞書仕訳を探す
といった動作です。これらの動作数はカウント上では１に過ぎませんが、実際は面倒な動作です。

**キータッチ数**は、次の仕訳に進むときEnterを連打した動作が数を増加させてます。いらないキータッチです。
マウススクロールもタッチ数１回にカウントしてますが、気持ちとしては５回くらいにカウントしたい重い動作です。

ちなみに、スキャン機を使った処理も、動作数、キータッチ数、作業時間でＰシステムの効率性より悪い成績でした。

### 解法２：再利用可能性の最大化

以上一連の作業は**仕訳の事前登録あり**という前提を置いています。
**仕訳の事前登録なし**だと各入力手段で入力効率はがくんと落ちます。

ですので、そもそも**仕訳の事前登録あり**という前提を置ける状態、言い換えると、**仕訳ライブラリにヒットするケース(=ヒット率)が多くなる**ことが効率化の条件です。最重要の要件であると考えています。

この**ヒット率**が各入力手段でどのように違うのか検証します。

**通常の会計ソフト**だとヒット率は通常**１割以下**です。これはちょっと経験ベースで証明はしきれないのですが。普通、気の利いた人が担当してても２、３割くらい仕訳辞書使えれば良い方じゃないですか？

**Ｐシステム**の方ですが、いま僕の事務所の環境でヒット率**７割５分**くらいになっています。
今までの利用で仕訳登録を増やしたことが要因ですが、Ｐシステムはこの「増やしやすさ」を一番の機能として設計したシステムです。

通常の会計ソフトであれば、仕訳登録は**その顧問先だけ**に**登録の作業が必要だ**という仕組みです。
わかりやすくするために、仮にこの状態をウォーズマンの超人強度100万パワーの状態だとします。

Ｐシステムでは手打ちした仕訳は**仕訳辞書へ自動登録することをデフォルト**にしています。これで200万パワー。
また、仕訳ライブラリには、その顧問先で登録した仕訳だけでなく、**他の顧問先の仕訳登録も貯まる仕組み**です。これで400万パワー。
さらに、**別のPC、別の担当者の登録も同様に貯めこむ**ため、これをくわえて1200万パワーとなります！

![picture_pc_41132d0613d8a89a5f07099ffdd6f74f.jpg](../_resources/picture_pc_41132d0613d8a89a5f07099ffdd6f74f.jpg)

現在の僕の事務所の仕訳ライブラリは 6,300件が参照できる状態になっています。これだけあれば大概の仕訳はヒットします。

例えば、このような初見の手書きの飲み屋の領収書があったとします。

![picture_pc_11e71f706bce8c7771efe1e6e45b5eba.jpg](../_resources/picture_pc_11e71f706bce8c7771efe1e6e45b5eba.jpg)

この場合、Ｐシステムでは名前をもとにダメ元で「677」と検索をかけます。（667は店舗名から変換した数字です。なぜ677になるのかは後述します）

マイナーな店舗であっても、他の担当者が別の顧問先で以前入力したということがしばしばあります。
本当に超マイナーな店舗でもライブラリに登録があったりするので、「こんな辺境の居酒屋、他に誰が…」とざわつけることもこのシステムの利点です。

**スキャン会計**でもヒット率はそこそこ高いとは思います。しかし、手書きの領収書を判別できないことが弱点です。
手書きの資料が出るたび内容から相手先まで手打ちする手間を考えると、どうにもスキャン会計に乗り換える気にはなりません。
順番が前後しますが、この**[ヒット率]**こそＰシステムの最大の利点だと考えています。

### 謎の変換技術

説明を飛ばしていた内容です。
効率化の参考にはならないのですが、説明しないと意味が分からない部分なので説明を加えます。

ここまでに書いた内容の中で、「アスクル」を「132」の数字で打ちこんだり、「居酒屋ぶももベーカリー」を「677」で打ち込んだりしています。
この変換がかなり謎でした。

解説のために、そもそもなぜこんな変換が必要かの成り立ちの説明をします。

システムを作るにあたり、動作最適化のための以下の課題がありました。
**● できるだけ視線移動をなくしたい
● 両手のポジションの変更動作をしたくない
● 左手は領収書めくりに必ず使う**
➡とすると、パンチは片手かつブラインドでしたい。
➡片手、ブラインドで打てるのはテンキーくらい。
➡文字を「数字」に置き換えればテンキーで入力できるのでないか？

という流れから、効率化のためには**文字を数字に変換するルール**が必要でした。そこで以下の文字変換規則を採用しました。

![picture_pc_aaedbb72093775afa71a8065f7a84367.jpg](../_resources/picture_pc_aaedbb72093775afa71a8065f7a84367.jpg)

上のルールに当てはめると「**AS**U**K**URU」は頭3文字の子音を使って数字「132」に変換されます。

妙な規則だと思うのですが、やってみると案外しっくりきます。事務所の人に覚えてもらっても、だいたい２、３日でものにできました。

……ちなみに、この変換表を使えば数字系の暗記が簡単になります。
大学受験や会計士受験をしてた昔から、この変換表は僕の中に持っていて、年号やら条文番号やらを文字に逆変換して暗記してました。なんかキモいな。

### ライブラリを使わない場合の仕訳入力

Pシステムにおいて、ライブラリに仕訳の登録がなかった場合の入力も解説しておきます。
手元に「場末の居酒屋」5,510円の領収書があるとします。仕訳入力は以下の流れになります。

![picture_pc_94dd65af8ac7fc73142c27c9289f65fc.gif](../_resources/picture_pc_94dd65af8ac7fc73142c27c9289f65fc.gif)

１．名前変換したコード番号（631）で相手先「場末の居酒屋」の仕訳登録がないかを確かめる。
２．1ページ目にも2ページ目にもないので、「＋」を押して新規登録モードに切り替える
３．科目や内容など、可能な限り辞書から番号で持ってくる
４．手打ちが必要な場面ではじめて、両手でキーボードを触り「場末の居酒屋」を入力
５．仕訳コードと金額を打つと、この仕訳がライブラリに自動登録される

ライブラリの登録がない場合は行程４でキーボードポジションに持ち換えて両手打ちしないといけないのですが、それでも従来ソフトよりは速く入力できます。

### その他最善化のための付加機能

このようなＰシステムなのですが、いろんな機能をつけています。
大きな機能で行けば、ここまで長々説明した**パンチのためのシステム**の他に以下の２つの別方面のシステムも入れています。

**■銀行データ取込システム**
銀行データ(csv,txt,xlsなど）から通帳取引を取込んで自動で仕訳に変換する機能です。大手会計ソフトでも最近よく実装されてるあれです。

**■取引を表形式で作成して、それを仕訳化するシステム
**意外と便利な表からの仕訳作成です。
毎月発生する棚卸調整とか減価償却概算とかそういった仕訳は表で管理しておいた方が打ちやすいし、後から見れたりもします。
さらに、銀行データ取込やパンチシステムとの連携機能があります。それによって売掛金などの消込管理ができたりします。

上の２つのシステムも解説したら長くなるのですが、長くなるのでやめておきます。
銀行データ取込機能は、大手会計ソフトが実装する前のfreeeが実装した同じ時期から実装している機能です。

その他、**パンチのためのシステム**にはいろいろ細かい機能を付加しています。

■金額入力前と次の仕訳移動時に**位置をBeep音でお知らせ**（ブラインド入力サポート）
■**入力金額の読み合わせ機能**（ON/OFF可)（ブラインド入力サポート）
■**残高金額の読み合わせ機能**（ON/OFF可)（ブラインド入力サポート）
■**勘定科目をマークでも表示**して視認性サポート
■**課税区分を色で表示**して視認性サポート、エラー防止

■連携指定をかけている仕訳は、日付や金額が**表形式シートの任意の場所に自動転記**（毎月発生する費用の管理に便利）（買掛金とかの消込、振込差額の仕訳化にも便利）

■日付の**「年」「月」の固定機能**（動作省略機能）
■**部門の固定入力機能**
■消費税の個別対応への自動変換機能
■科目に応じて金額のプラマイは自動判定（動作省略機能）
■振伝作成機能
■最頻利用仕訳をゼロ番に登録して簡単再利用（動作省略機能）
■半角化、全角化の状況に応じた自動サポート（動作省略機能）

### システムの公開

せっかくここまで書いたのだから下にシステムを公開します。
ただやや二の足を踏みました。

そもそも、このシステム使うにはある程度Ｐシステムへのコミットがいります。①謎の変換技術を覚えて、②ある程度使い続けて仕訳辞書を貯めるというハードルがあるためです。

なので、こんなネットで公開してるやつを使う人なんている？という疑問があったからです。

まあでも、使わなくても何らかの参考くらいにはなるでしょう。
事務所のシステムから切り出しました。興味がある方は見てみてください。最初に仕訳ライブラリを作るために「設定」シートのいくつかの手順を踏む必要があります。

仕組みはExcel VBAで作っていますのでOfficeが入っていてマクロを有効にしたら動きます。
--------------------------------
**■JournalEntry(R2.9.15up)**

[ **JournalEntry.xlsm** 249154 Bytes  ファイルダウンロードについて      ダウンロード](https://note.com/api/v2/attachments/download/64425936d4553f5ddbab62b07dfb3a95)

ここまでPシステムと書いてましたが、事務所内ではJournalEntryというシステム名で呼んでます。
--------------------------------

### 細かすぎて伝わらない技術的なアイデア

さらに、僕がここを頑張ったんだと主張したい技術的なアイデアを書いておきます。事務所内で言っても細かすぎていまいち伝わらなかった話です。
本当はここがアイデアを絞ったところなので、僕はここを褒めてほしかったんですよ！

**■仕訳ライブラリの量と使いやすさの両立**

Ｐシステムの利点は、仕訳ライブラリの量が事務所全体を巻き込んでどんどん増えることです。しかしライブラリ量の増加は目的の仕訳を見つけにくくなるというジレンマを生みます。

その解決の一つとして、画面の半分を仕訳検索の画面に充てたり、マークや色で検索性を高めるという方法をとっています。

しかし一番有効なのは、ほしい仕訳がすぐ表示されることです。

Ｐシステムでは、表示する仕訳の順番を、①自顧客で登録した仕訳➡②顧客登録なし仕訳➡③他の顧客で登録した仕訳としています。そのうえで、その区分内で利用頻度が高いものを上位に表示させています。

システム的難易度は低いのですが、実際活用してみるとかなり有効な解決法でした。
**■ 別のPC間で仕訳辞書を共有できる**
このＰシステムはExcelのVBAで作っています。とすると、基本的に一つExcelファイルAは他のファイルBに影響を与えないはずです。
しかし仕訳ライブラリは共有している。ということは、仕訳ライブラリは別枠で一元管理する仕組みが必要ですよね。
また、PCが違っても仕訳ライブラリは共有されます。ということは一元管理は社内ネットワーク上行う必要がある。
さらに、社内ネットワーク環境内だけでなく、外に出た時も仕訳ライブラリは共有されています。さあどうする？
このへんの問題を解決しています。でも事務所では誰もそこに気づいてくれない。

**■パンチシステムの同時使用が可能**
事務所内での活用度の高いシステムなので複数人が同時にＰシステムを使うことがあります。その場合、各人がそれぞれ同時に新規仕訳の登録をしたりします。
ここで問題となるのは、皆が同じ仕訳ライブラリを共有参照しているのに、それに変更を加えることは可能なのかという問題です。
追加だけならappendすればいいですよね。
じゃあ登録仕訳の変更や削除は？難しめの問題です。
これも工夫で解決させました。ただその大変さに誰も気づいてくれない。

**■システムの更新の並列化**

Ｐシステムは新しい効率化アイデアを取り入れるため、結構頻繁にシステムの更新をしました。また、軽減税率が開始したりで求められる機能も制度により変わるため更新をかけています。

ＰシステムはExcelファイルですので、顧客ごとに何十個のExcelファイルとして散らばっています。システムの更新があるたびにそれを一つづつ書き換えるのは相当手間ですよね。

システム更新が並列化するよう工夫して解決しています。ただ誰も（ｒｙ